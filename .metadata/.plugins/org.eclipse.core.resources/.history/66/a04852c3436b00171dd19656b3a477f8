package com.ght.conexion;

import java.sql.ResultSet;
import java.util.Calendar;

public class ConnUsuarios {

	private ConnDAO conn;
	
	public ConnUsuarios() {
		this.conn = new ConnDAO();
	}
	
	public Object[] iniciarSession(String nombre, String passw){
		Object[] retorno = new String[2];
		String query = "SELECT nombre, tipo FROM usuarios WHERE nombre LIKE '%"+nombre+"%' AND passw = '"+passw+"'";
		try {
			ResultSet result = conn.buscar(query);
			result.next();
			retorno[0] = result.getString("nombre");
			retorno[1] = result.getString("tipo");
			result.close();
			return retorno;
		} catch (Exception e) {
			System.out.println("No se ha podido validar usuario: " + e.getMessage());
		}
		return retorno;
	}
	
	/**
	 * Metodo que escribe sql para que la classe
	 * de conexión efectivamente lo grabe en la base.
	 * @return true or false
	 */
	
	public boolean saveUsuario(String nombre, String login, String passw, int categoria) {
		//TO DO: considerar herança para objetos de conexão.
		Calendar calendar = Calendar.getInstance();
		String creacion = calendar.YEAR + "-" + calendar.MONTH + "-" + calendar.DATE + calendar.getTime().toString();
		String query = "INSERT INTO USUARIOS (creacion, nombre, login, passw, codCategoria)" +
				"("+creacion+", "+
				    nombre+", "+
				    login+", "+
				    passw+", "+
				    categoria+", "+
				;
		try {
			conn.insere(query);
		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
		return false;
	}
}
